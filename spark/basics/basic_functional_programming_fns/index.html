<!DOCTYPE html>
<html lang="en">

<head>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66582-32"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-66582-32');
    </script>

    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Basic Functional Programming Functions" />
<meta property="og:description" content="import findspark findspark.init() import pyspark sc = pyspark.SparkContext() Basic Functional Programming Functions Spark has plenty of analogues to the native Python fucntional programming methods. However, as discussed in Transformations and Actions, nothing gets evaluated, merely strung together into RDDs. Only when we call some sort of Action do we get any actual computation.
Let&rsquo;s consider a simple dataset
rdd = sc.parallelize([1, 2, 3, 4, 5]) Familiar fns Map mapped = rdd." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://napsterinblue.github.io/notes/spark/basics/basic_functional_programming_fns/" />



<meta property="article:published_time" content="2018-05-23T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2018-05-23T00:00:00&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Basic Functional Programming Functions"/>
<meta name="twitter:description" content="import findspark findspark.init() import pyspark sc = pyspark.SparkContext() Basic Functional Programming Functions Spark has plenty of analogues to the native Python fucntional programming methods. However, as discussed in Transformations and Actions, nothing gets evaluated, merely strung together into RDDs. Only when we call some sort of Action do we get any actual computation.
Let&rsquo;s consider a simple dataset
rdd = sc.parallelize([1, 2, 3, 4, 5]) Familiar fns Map mapped = rdd."/>
<meta name="generator" content="Hugo 0.40.3" />

    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Basic Functional Programming Functions",
  "url": "https://napsterinblue.github.io/notes/spark/basics/basic_functional_programming_fns/",
  "wordCount": "325",
  "datePublished": "2018-05-23T00:00:00&#43;00:00",
  "dateModified": "2018-05-23T00:00:00&#43;00:00",
  "author": {
    "@type": "Person",
    "name": ""
  }
}
</script> 

    <title>Basic Functional Programming Functions</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">

    
    <link href="https://napsterinblue.github.io/notes/css/custom.css" rel="stylesheet">
    <link href="https://napsterinblue.github.io/notes/css/syntax.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,500,700" rel="stylesheet">

    <link href="" rel="alternate" type="application/rss+xml" title="Data Science Notes" />

    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

</head>

<body>

    <nav class="navbar navbar-expand-sm fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="https://napsterinblue.github.io">Movies, Metrics, Musings</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav mr-auto"></ul>
                <ul class="nav navbar-nav">
                    <li><a href="https://napsterinblue.github.io/pages/about.html" title="About">About</a></li>
                    <li><a href="https://napsterinblue.github.io/archives.html" title="Archive">Archive</a></li>
                    <li><a href="https://napsterinblue.github.io/pages/resources.html" title="Resources">Resources</a></li>
                    <li><a href="https://napsterinblue.github.io/notes/" title="Notes">My Notes</a></li>

                </ul>
            </div>
        </div>
    </nav>


    
    <div class="container">
        <div class="row">
            <div class="col-sm-12">

                 


<article>
  <div class="technical_note">
  <header>
    <h1 class="technical_note_title">Basic Functional Programming Functions</h1>
    <div class="technical_note_date">
      <time datetime=" 2018-05-23T00:00:00Z "> 23 May 2018</time>
    </div>
  </header>
  <div class="content">
  

<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">findspark</span>
<span class="n">findspark</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">pyspark</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">SparkContext</span><span class="p">()</span></code></pre></div>
<h2 id="basic-functional-programming-functions">Basic Functional Programming Functions</h2>

<p>Spark has plenty of analogues to the native Python fucntional programming methods. However, as discussed in <a href="https://napsterinblue.github.io/notes/spark/basics/transformations_and_actions/">Transformations and Actions</a>, nothing gets <em>evaluated</em>, merely strung together into RDDs. Only when we call some sort of Action do we get any actual computation.</p>

<p>Let&rsquo;s consider a simple dataset</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span></code></pre></div>
<h2 id="familiar-fns">Familiar fns</h2>

<h3 id="map">Map</h3>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">mapped</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">64</span><span class="p">))</span>
<span class="n">mapped</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span></code></pre></div>
<pre><code>['A', 'B', 'C', 'D', 'E']
</code></pre>

<h3 id="filter">Filter</h3>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">filtered</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">filtered</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span></code></pre></div>
<pre><code>[2, 3, 4, 5]
</code></pre>

<h3 id="reduce">Reduce</h3>

<p>The <code>reduce</code> function is an Action, thus gets evaluated.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">add</span>

<span class="n">added</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="nb">reduce</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
<span class="n">added</span></code></pre></div>
<pre><code>15
</code></pre>

<h2 id="new-fns">New fns</h2>

<h3 id="flatmap">FlatMap</h3>

<p>Flatmap combines typical mapping with behavior similar to the <code>itertools.chain</code> function</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">text</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s1">&#39;../data/zen.txt&#39;</span><span class="p">)</span></code></pre></div>
<p>Calling just <code>map.split()</code> on our text file returns a list of lists, split over newlines.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="o">.</span><span class="n">collect</span><span class="p">()[:</span><span class="mi">3</span><span class="p">])</span></code></pre></div>
<pre><code>[['Beautiful', 'is', 'better', 'than', 'ugly.'], ['Explicit', 'is', 'better', 'than', 'implicit.'], ['Simple', 'is', 'better', 'than', 'complex.']]
</code></pre>

<p>However, using flatmap, we consolidate many sublists into one list.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="o">.</span><span class="n">collect</span><span class="p">()[:</span><span class="mi">30</span><span class="p">])</span></code></pre></div>
<pre><code>['Beautiful', 'is', 'better', 'than', 'ugly.', 'Explicit', 'is', 'better', 'than', 'implicit.', 'Simple', 'is', 'better', 'than', 'complex.', 'Complex', 'is', 'better', 'than', 'complicated.', 'Flat', 'is', 'better', 'than', 'nested.', 'Sparse', 'is', 'better', 'than', 'dense.']
</code></pre>

<h2 id="fold">Fold</h2>

<p>Simlar to the <code>reduce</code> function, <code>fold</code> consolidates many records into one value. There difference here, though, is that we can specify a starting value to begin reduction on.</p>

<p>For instance:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="n">rdd</span><span class="o">.</span><span class="nb">reduce</span><span class="p">(</span><span class="n">add</span><span class="p">)</span></code></pre></div>
<pre><code>45
</code></pre>

<p>Here we specify that we want to add the numbers [0:10) to the number 99.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">rdd</span><span class="o">.</span><span class="n">fold</span><span class="p">(</span><span class="mi">99</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></code></pre></div>
<pre><code>540
</code></pre>

<p>This might seem unintuitive. However, <code>fold</code> works at the <em>partition</em> level. Peeking behind the curtain with the <code>glom</code> function, we can see that our original dataset is split up across 5 different partitions</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">rdd</span><span class="o">.</span><span class="n">glom</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span></code></pre></div>
<pre><code>[[0, 1], [2, 3, 4], [5, 6], [7, 8, 9]]
</code></pre>

<p>Therefore, the <code>reduce</code> step happens across each of them and are then reduced together, which works out to:</p>

<p>$99*5 + \sum\limits_{i=1}^{9}{i} = 540$</p>

</div>
  <aside>
      <div class="bug_reporting">
          <h4>Find an error or bug?</h4>
          <p>Everything on this site is available on GitHub. Head to <a href='https://github.com/napsterinblue/notes/issues/new'>and submit a suggested change</a>. You can also message me directly on <a href='https://twitter.com/napsterinblue'>Twitter</a>.</p>
      </div>
      </aside>

    </div>
</article>




            </div>

        </div>
    </div>

    

    <footer class="footer text-center">
        <div class="container">
            <span class="text-muted">This project contains 113 pages and is available on <a href="https://github.com/napsterinblue/notes">GitHub</a>. Copyright &copy; NapsterInBlue, <time datetime="2018">2018</time>.</span>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>

</body>

</html>
